---
name: ğŸ“ ë¦¬ë·° ê³¼ì œ
about: YBì‹¬í™” ì„¸ì…˜ íšŒê³  í…œí”Œë¦¿
title: '[Week 2] 2ì£¼ì°¨ ë¦¬ë·° - ì •ìœ ì§„'
labels: ['review']
assignees: ''
---

## ì£¼ì œ
- ì¶”ì²œ ì‹œìŠ¤í…œ ì ‘ëª© ì‹¤ì œ ì˜ˆì‹œ (Youtube ì´ì™¸): ìŒì•… ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ ì¶”ì²œ ì‹œìŠ¤í…œ ì‹¬ì¸µ ë¶„ì„ ë° ë¹„êµ (Apple Music, Spotify, etc.)
- ì´ë²ˆ ì£¼ êµì¬ ë‚´ìš© ë”¥ë‹¤ì´ë¸Œ: ì‹¬ì¸µ ì‹ ê²½ë§(DNN) ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œ ëª¨ë¸ ì‹¬ì¸µ ë¶„ì„
- (ì„ íƒ) ê²½ëŸ‰í™” DNN (ë°œì œ ë‚´ìš©) ì½”ë“œ ì´í•´ ë° ì ìš© ë°©ì•ˆ ì—°êµ¬

## ë‚´ìš©

### 1. ì¶”ì²œ ì‹œìŠ¤í…œ ì ‘ëª© ì‹¤ì œ ì˜ˆì‹œ: ìŒì•… ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ ì¶”ì²œ ì‹œìŠ¤í…œ ì‹¬ì¸µ ë¶„ì„ ë° ë¹„êµ
ë¥¼ í•˜ê¸° ì „ì— ì œê°€ ì „ì— ê¶ê¸ˆí•´ì„œ ì¡°ì‚¬í–ˆë˜ ì¹´ì¹´ì˜¤ë®¤ì§ ì¶”ì²œì‹œìŠ¤ í…œê´€ë ¨ ê¸€ì´
https://realalpaca01.tistory.com/entry/%EC%8A%A4%ED%8A%B8%EB%A6%AC%EB%B0%8D-%EC%84%9C%EB%B9%84%EC%8A%A4-%EB%A9%94%EB%9A%9C%EA%B8%B0%EC%9D%98-%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C-%EB%B9%84%EA%B5%90%EC%A3%BC%EA%B4%80%EC%A0%81?category=1216250
ì´ê²ƒë„ ë´ì£¼ì‹œë¼ìš”...



#### 1.1. ìŒì•… ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ ì¶”ì²œ ì‹œìŠ¤í…œ ê°œìš”

ìŒì•… ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ëŠ” ì‚¬ìš©ìì—ê²Œ ê°œì¸í™”ëœ ìŒì•… ì¶”ì²œì„ ì œê³µí•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ê° ì„œë¹„ìŠ¤ëŠ” ê³ ìœ í•œ ë°ì´í„°ì™€ ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•˜ì—¬ ì‚¬ìš©ì ë§Œì¡±ë„ë¥¼ ë†’ì´ê³  ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ì„¹ì…˜ì—ì„œëŠ” Apple Music, Spotify, YouTube Musicì„ ë¹„êµ ë¶„ì„í•©ë‹ˆë‹¤.

#### 1.2. ìŒì•… ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ë³„ ì¶”ì²œ ì‹œìŠ¤í…œ ë¹„êµ

| ì„œë¹„ìŠ¤      | ì£¼ìš” ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜                               | íŠ¹ì§•                                                                                                                                  | ì¥ì                                                                                                                                      | ë‹¨ì                                                                                                                             |
| ----------- | ------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| Apple Music | í˜‘ì—… í•„í„°ë§, ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§, ë”¥ëŸ¬ë‹ ê¸°ë°˜ ëª¨ë¸ | ì „ë¬¸ê°€ íë ˆì´ì…˜, ì‚¬ìš©ì ì·¨í–¥ ë¶„ì„, Apple ìƒíƒœê³„ ì—°ë™                                                                                    | ë†’ì€ ìŒì§ˆ, íë ˆì´ì…˜ ê¸°ëŠ¥, ì˜¤í”„ë¼ì¸ ì¬ìƒ                                                                                                  | ê°œì¸í™” ì¶”ì²œ ì •í™•ë„ í¸ì°¨, íì‡„ì ì¸ ìƒíƒœê³„                                                                                       |
| Spotify     | í˜‘ì—… í•„í„°ë§, ìì—°ì–´ ì²˜ë¦¬, ë”¥ëŸ¬ë‹ ê¸°ë°˜ ëª¨ë¸         | Discover Weekly, Release Radar, ì‚¬ìš©ì í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë¶„ì„                                                                                | ê°œì¸í™” ì¶”ì²œ ê°•ì , ë‹¤ì–‘í•œ ì¥ë¥´ ì§€ì›, ì†Œì…œ ê¸°ëŠ¥                                                                                            | ìŒì§ˆ ìƒëŒ€ì  ì—´ì„¸, íŒŸìºìŠ¤íŠ¸ ê´‘ê³                                                                                               |
| YouTube Music | ë”¥ëŸ¬ë‹ ê¸°ë°˜ ëª¨ë¸, ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§               | YouTube ë°ì´í„° í™œìš©, ì‚¬ìš©ìì˜ ì‹œì²­ ê¸°ë¡ ë¶„ì„, ìŒì•… ì™¸ ë‹¤ì–‘í•œ ì½˜í…ì¸  ì¶”ì²œ                                                                 | ë°©ëŒ€í•œ ìŒì› ë¼ì´ë¸ŒëŸ¬ë¦¬, ë®¤ì§ë¹„ë””ì˜¤ ì§€ì›, ë‹¤ë¥¸ Google ì„œë¹„ìŠ¤ ì—°ë™                                                                         | ê°œì¸í™” ì¶”ì²œ ì •í™•ë„ ê°œì„  í•„ìš”, ê´‘ê³                                                                                               |

#### 1.3. ê¸°ìˆ ì  ë¶„ì„

##### 1.3.1. í˜‘ì—… í•„í„°ë§ (Collaborative Filtering)

**ì •ì˜:** ì‚¬ìš©ì-ì•„ì´í…œ ìƒí˜¸ì‘ìš© íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œì„ ì œê³µí•˜ëŠ” ë°©ë²•. ìœ ì‚¬í•œ ì‚¬ìš©ìì˜ í–‰ë™ì„ ë¶„ì„í•˜ê±°ë‚˜ ìœ ì‚¬í•œ ì•„ì´í…œì„ ì°¾ì•„ ì¶”ì²œí•©ë‹ˆë‹¤.

**ìˆ˜ì‹:**

*   ì‚¬ìš©ì ê¸°ë°˜ í˜‘ì—… í•„í„°ë§:

    ```
    similarity(u, v) = Î£(i âˆˆ Iuv) rui * rvi / (sqrt(Î£(i âˆˆ Iu) rui^2) * sqrt(Î£(i âˆˆ Iv) rvi^2))
    prediction(u, i) = Î£(v âˆˆ Nu) similarity(u, v) * rvi / Î£(v âˆˆ Nu) |similarity(u, v)|
    ```

    ì—¬ê¸°ì„œ,

    *   `u`, `v`: ì‚¬ìš©ì
    *   `i`: ì•„ì´í…œ
    *   `rui`: ì‚¬ìš©ì `u`ê°€ ì•„ì´í…œ `i`ì— ì¤€ í‰ì 
    *   `Iuv`: ì‚¬ìš©ì `u`ì™€ `v`ê°€ ëª¨ë‘ í‰ê°€í•œ ì•„ì´í…œ ì§‘í•©
    *   `Nu`: ì‚¬ìš©ì `u`ì™€ ìœ ì‚¬í•œ ì‚¬ìš©ì ì§‘í•©

*   ì•„ì´í…œ ê¸°ë°˜ í˜‘ì—… í•„í„°ë§:

    ```
    similarity(i, j) = Î£(u âˆˆ Uij) rui * ruj / (sqrt(Î£(u âˆˆ Ui) rui^2) * sqrt(Î£(u âˆˆ Uj) ruj^2))
    prediction(u, i) = Î£(j âˆˆ Ni) similarity(i, j) * ruj / Î£(j âˆˆ Ni) |similarity(i, j)|
    ```

    ì—¬ê¸°ì„œ,

    *   `i`, `j`: ì•„ì´í…œ
    *   `u`: ì‚¬ìš©ì
    *   `Uij`: ì•„ì´í…œ `i`ì™€ `j`ë¥¼ ëª¨ë‘ í‰ê°€í•œ ì‚¬ìš©ì ì§‘í•©
    *   `Ni`: ì•„ì´í…œ `i`ì™€ ìœ ì‚¬í•œ ì•„ì´í…œ ì§‘í•©

**ì ìš© ì˜ˆì‹œ:** Spotifyì˜ Discover WeeklyëŠ” í˜‘ì—… í•„í„°ë§ì„ í†µí•´ ì‚¬ìš©ìì™€ ìœ ì‚¬í•œ ì·¨í–¥ì„ ê°€ì§„ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì´ ì¦ê²¨ ë“£ëŠ” ìŒì•…ì„ ì¶”ì²œí•©ë‹ˆë‹¤.

##### 1.3.2. ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§ (Content-Based Filtering)

**ì •ì˜:** ì•„ì´í…œì˜ ë©”íƒ€ë°ì´í„°(ì¥ë¥´, ì•„í‹°ìŠ¤íŠ¸, ê°€ì‚¬ ë“±)ë¥¼ ë¶„ì„í•˜ì—¬ ì‚¬ìš©ìê°€ ì„ í˜¸í•  ë§Œí•œ ì•„ì´í…œì„ ì¶”ì²œí•˜ëŠ” ë°©ë²•.

**ìˆ˜ì‹:**

*   ì•„ì´í…œ í”„ë¡œí•„ ìƒì„±:

    ```
    profile(i) = Î£(f âˆˆ Fi) wif * feature(f)
    ```

    ì—¬ê¸°ì„œ,

    *   `i`: ì•„ì´í…œ
    *   `Fi`: ì•„ì´í…œ `i`ì˜ íŠ¹ì§• ì§‘í•©
    *   `wif`: íŠ¹ì§• `f`ì˜ ê°€ì¤‘ì¹˜
    *   `feature(f)`: íŠ¹ì§• `f`ì˜ ê°’

*   ì‚¬ìš©ì í”„ë¡œí•„ ìƒì„±:

    ```
    profile(u) = Î£(i âˆˆ Iu) rui * profile(i) / Î£(i âˆˆ Iu) rui
    ```

    ì—¬ê¸°ì„œ,

    *   `u`: ì‚¬ìš©ì
    *   `Iu`: ì‚¬ìš©ì `u`ê°€ í‰ê°€í•œ ì•„ì´í…œ ì§‘í•©
    *   `rui`: ì‚¬ìš©ì `u`ê°€ ì•„ì´í…œ `i`ì— ì¤€ í‰ì 

*   ì¶”ì²œ ì ìˆ˜ ê³„ì‚°:

    ```
    score(u, i) = cosine_similarity(profile(u), profile(i))
    ```

**ì ìš© ì˜ˆì‹œ:** Apple Musicì€ ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§ì„ í†µí•´ ì‚¬ìš©ìê°€ ì´ì „ì— ë“¤ì—ˆë˜ ìŒì•…ê³¼ ìœ ì‚¬í•œ ì¥ë¥´ë‚˜ ì•„í‹°ìŠ¤íŠ¸ì˜ ìŒì•…ì„ ì¶”ì²œí•©ë‹ˆë‹¤.

##### 1.3.3. ë”¥ëŸ¬ë‹ ê¸°ë°˜ ëª¨ë¸ (Deep Learning-Based Models)

**ì •ì˜:** ì‹¬ì¸µ ì‹ ê²½ë§ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì-ì•„ì´í…œ ê°„ì˜ ë³µì¡í•œ ê´€ê³„ë¥¼ ëª¨ë¸ë§í•˜ê³  ì¶”ì²œì„ ì œê³µí•˜ëŠ” ë°©ë²•.

**ëª¨ë¸ ì¢…ë¥˜:**

*   **NeuMF (Neural Matrix Factorization):** í–‰ë ¬ ë¶„í•´ì™€ ì‹ ê²½ë§ì„ ê²°í•©í•˜ì—¬ ì‚¬ìš©ì-ì•„ì´í…œ ê°„ì˜ ì ì¬ì  ìƒí˜¸ì‘ìš© í•™ìŠµ.
![alt text](image.png)
*   **DeepFM (Deep Factorization Machine):** Factorization Machine (FM)ê³¼ ì‹¬ì¸µ ì‹ ê²½ë§ì„ ê²°í•©í•˜ì—¬ íŠ¹ì§• ê°„ì˜ ìƒí˜¸ì‘ìš© ëª¨ë¸ë§.
![alt text](image-1.png)
   

**ìˆ˜ì‹:**
*   NeuMF:

    ```
    prediction(u, i) = Ïƒ(h^T * Ï†(pu, qi))
    ```

    ì—¬ê¸°ì„œ,

    *   `pu`: ì‚¬ìš©ì `u`ì˜ ì„ë² ë”© ë²¡í„°
    *   `qi`: ì•„ì´í…œ `i`ì˜ ì„ë² ë”© ë²¡í„°
    *   `Ï†`: ì‹ ê²½ë§ ëª¨ë¸
    *   `h`: ì¶œë ¥ ê°€ì¤‘ì¹˜ ë²¡í„°
    *   `Ïƒ`: ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜

**ì ìš© ì˜ˆì‹œ:** YouTube Musicì€ ë”¥ëŸ¬ë‹ ê¸°ë°˜ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ì‹œì²­ ê¸°ë¡ê³¼ ê²€ìƒ‰ ê¸°ë¡ì„ ë¶„ì„í•˜ê³ , ê°œì¸í™”ëœ ìŒì•… ì¶”ì²œì„ ì œê³µí•©ë‹ˆë‹¤.

#### 1.4. ìŒì•… ìŠ¤íŠ¸ë¦¬ë° ì„œë¹„ìŠ¤ ì¶”ì²œ ì‹œìŠ¤í…œì˜ í•œê³„ ë° ê°œì„  ë°©í–¥

*   **ë°ì´í„° í¬ì†Œì„± ë¬¸ì œ:** ì‚¬ìš©ìì˜ í‰ê°€ë‚˜ ì²­ì·¨ ê¸°ë¡ì´ ë¶€ì¡±í•  ê²½ìš° ì¶”ì²œ ì •í™•ë„ê°€ ë‚®ì•„ì§€ëŠ” ë¬¸ì œ.
    *   **ê°œì„  ë°©í–¥:** ì½œë“œ ìŠ¤íƒ€íŠ¸ ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ì½˜í…ì¸  ë©”íƒ€ë°ì´í„° í™œìš©, ì‚¬ìš©ì ì´ˆê¸° í–‰ë™ íŒ¨í„´ ë¶„ì„, ëŠ¥ë™ì  í”¼ë“œë°± ìœ ë„.
*   **ë‹¤ì–‘ì„± ë¶€ì¡± ë¬¸ì œ:** ì‚¬ìš©ìì˜ ê¸°ì¡´ ì„ í˜¸ì— ì¹˜ìš°ì¹œ ì¶”ì²œìœ¼ë¡œ ìƒˆë¡œìš´ ìŒì•… ë°œê²¬ ê¸°íšŒ ê°ì†Œ.
    *   **ê°œì„  ë°©í–¥:** íƒìƒ‰-í™œìš© ê· í˜• ì•Œê³ ë¦¬ì¦˜ ì ìš©, ìŒì•… ë‹¤ì–‘ì„± í™•ë³´, ì‹¤í—˜ì  ì¶”ì²œ ë„ì….
*   **ì„¤ëª… ê°€ëŠ¥ì„± ë¶€ì¡± ë¬¸ì œ:** ì¶”ì²œ ì´ìœ ì— ëŒ€í•œ ëª…í™•í•œ ì„¤ëª… ë¶€ì¬ë¡œ ì‚¬ìš©ìì˜ ì‹ ë¢°ë„ í•˜ë½.
    *   **ê°œì„  ë°©í–¥:** ì¶”ì²œ ì´ìœ  ì‹œê°í™”, ì‚¬ìš©ì í”¼ë“œë°± ë°˜ì˜, íˆ¬ëª…ì„± ê°•í™”.

#### 1.5. ë¨¸ë©”ì´ë“œ ë‹¤ì´ì–´ê·¸ë¨

```
graph LR
    A[ì‚¬ìš©ì] --> B(ë°ì´í„° ìˆ˜ì§‘);
    B --> C{ë°ì´í„° ë¶„ì„};
    C --> D[ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜];
    D --> E{ê°œì¸í™”ëœ ìŒì•… ì¶”ì²œ};
    E --> F[ì‚¬ìš©ì í”¼ë“œë°±];
    F --> B;
```

### 2. ì‹¬ì¸µ ì‹ ê²½ë§(DNN) ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œ ëª¨ë¸ ì‹¬ì¸µ ë¶„ì„

#### 2.1. DNN ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œ ê°œìš”

DNN ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œì€ ê¸°ì¡´ ì¶”ì²œ ì‹œìŠ¤í…œì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³ , ë‹¤ì–‘í•œ í˜•íƒœì˜ ë°ì´í„°ë¥¼ í†µí•©ì ìœ¼ë¡œ í™œìš©í•˜ì—¬ ì¶”ì²œ ì •í™•ë„ë¥¼ í–¥ìƒì‹œí‚¤ëŠ” ëª¨ë¸ì…ë‹ˆë‹¤. íŠ¹íˆ, ì‚¬ìš©ì-ì•„ì´í…œ ê°„ì˜ ë³µì¡í•œ ë¹„ì„ í˜• ê´€ê³„ë¥¼ ëª¨ë¸ë§í•˜ëŠ” ë° ê°•ì ì„ ê°€ì§‘ë‹ˆë‹¤.

#### 2.2. DNNê³¼ ê²½ëŸ‰í™” DNNì˜ êµ¬ì¡° ë¹„êµ

```mermaid
graph LR
    %% ì…ë ¥ ë°ì´í„°
    A[ì…ë ¥ ë°ì´í„°<br>Input Features] --> B[ì¼ë°˜ DNN]
    A --> E[ê²½ëŸ‰í™” DNN]
    
    %% ì¼ë°˜ DNN ê²½ë¡œ
    subgraph Traditional[ì¼ë°˜ DNN êµ¬ì¡°]
        B --> C1[Dense Layer 1<br>ë§ì€ íŒŒë¼ë¯¸í„°]
        C1 --> C2[Dense Layer 2<br>í° ë©”ëª¨ë¦¬ ì‚¬ìš©]
        C2 --> C3[Dense Layer N<br>ë†’ì€ ì—°ì‚°ëŸ‰]
        C3 --> D[ì¶œë ¥<br>High Accuracy]
    end
    
    %% ê²½ëŸ‰í™” DNN ê²½ë¡œ
    subgraph Lightweight[ê²½ëŸ‰í™” DNN êµ¬ì¡°]
        E --> F1[Depthwise Conv<br>ì±„ë„ë³„ ë…ë¦½ ì—°ì‚°]
        F1 --> F2[Pointwise Conv<br>1x1 í•©ì„±ê³±]
        F2 --> F3[Bottleneck<br>ì°¨ì› ì¶•ì†Œ]
        F3 --> G[ì¶œë ¥<br>Fast Inference]
    end
    
    %% íŠ¹ì§• ì„¤ëª…
    subgraph Features[ëª¨ë¸ íŠ¹ì§• ë¹„êµ]
        Traditional_Features[ì¼ë°˜ DNN:<br>- ë†’ì€ ì •í™•ë„<br>- í° ëª¨ë¸ í¬ê¸°<br>- ë§ì€ ì—°ì‚°ëŸ‰]
        Lightweight_Features[ê²½ëŸ‰í™” DNN:<br>- ë¹ ë¥¸ ì¶”ë¡ <br>- ì‘ì€ ë©”ëª¨ë¦¬<br>- ëª¨ë°”ì¼ ìµœì í™”]
    end
    
    %% ìŠ¤íƒ€ì¼ ì •ì˜
    classDef regular fill:#f96,stroke:#333,stroke-width:2px;
    classDef lightweight fill:#6cf,stroke:#333,stroke-width:2px;
    classDef feature fill:#fff,stroke:#999,stroke-width:1px;
    
    %% ìŠ¤íƒ€ì¼ ì ìš©
    class B,C1,C2,C3,D regular;
    class E,F1,F2,F3,G lightweight;
    class Traditional_Features,Lightweight_Features feature;
```

##### 2.2.1. êµ¬ì¡°ë³„ íŠ¹ì§•

###### ì¼ë°˜ DNN
- **êµ¬ì¡°**: ì „í†µì ì¸ Dense Layer(ì™„ì „ ì—°ê²° ê³„ì¸µ)ë¡œ êµ¬ì„±ë˜ë©°, ê° ì¸µì—ì„œ ëª¨ë“  ì…ë ¥ ë…¸ë“œì™€ ì¶œë ¥ ë…¸ë“œê°€ ì—°ê²°ë¨
- **ì¥ì **: ë†’ì€ í‘œí˜„ë ¥ê³¼ ì„±ëŠ¥
- **ë‹¨ì **: ëª¨ë°”ì¼ í™˜ê²½ì´ë‚˜ ì„ë² ë””ë“œ ì¥ì¹˜ì—ì„œ ì‹¤í–‰í•˜ê¸° ì–´ë ¤ì›€

###### ê²½ëŸ‰í™” DNN
- **êµ¬ì¡°**: Depthwise Convolution, Pointwise Convolution, Bottleneck Layer ë“±ì„ í™œìš©í•œ íš¨ìœ¨ì  êµ¬ì¡°
- **ì¥ì **: ë¹ ë¥¸ ì¶”ë¡  ì†ë„ì™€ ë‚®ì€ ë©”ëª¨ë¦¬ ìš”êµ¬ì‚¬í•­
- **ë‹¨ì **: ì¼ë°˜ DNNì— ë¹„í•´ ì„±ëŠ¥ì´ ì•½ê°„ ì €í•˜ë  ìˆ˜ ìˆìŒ

##### 2.2.2. ì—°ì‚°ëŸ‰ ë¹„êµ

###### ì¼ë°˜ Convolution
- íŒŒë¼ë¯¸í„° ìˆ˜: $K \times K \times C_{in} \times C_{out}$
- ì—°ì‚°ëŸ‰: $K \times K \times C_{in} \times C_{out} \times H \times W$

###### Depthwise Separable Convolution
- Depthwise Convolution:
  - íŒŒë¼ë¯¸í„° ìˆ˜: $K \times K \times C_{in}$
  - ì—°ì‚°ëŸ‰: $K \times K \times C_{in} \times H \times W$
- Pointwise Convolution:
  - íŒŒë¼ë¯¸í„° ìˆ˜: $C_{in} \times C_{out}$
  - ì—°ì‚°ëŸ‰: $C_{in} \times C_{out} \times H \times W$

#### 2.3. ì£¼ìš” ëª¨ë¸ êµ¬ì¡°

- **ì†ì‹¤ í•¨ìˆ˜:**
    - ì´ì§„ êµì°¨ ì—”íŠ¸ë¡œí”¼ (Binary Cross-Entropy): í´ë¦­ ì—¬ë¶€ ì˜ˆì¸¡
    - í‰ê·  ì œê³± ì˜¤ì°¨ (Mean Squared Error): í‰ì  ì˜ˆì¸¡
- **ìµœì í™” ì•Œê³ ë¦¬ì¦˜:**
    - Adam, SGD ë“±
- **ì •ê·œí™” ê¸°ë²•:**
    - ë“œë¡­ì•„ì›ƒ (Dropout), ë°°ì¹˜ ì •ê·œí™” (Batch Normalization)

#### 2.4. DNN ê¸°ë°˜ ì¶”ì²œ ì‹œìŠ¤í…œì˜ ì¥ë‹¨ì 

- **ì¥ì :**
    - ë†’ì€ ì¶”ì²œ ì •í™•ë„
    - ë‹¤ì–‘í•œ í˜•íƒœì˜ ë°ì´í„° í†µí•© ê°€ëŠ¥
    - ë³µì¡í•œ ë¹„ì„ í˜• ê´€ê³„ ëª¨ë¸ë§ ê°€ëŠ¥
- **ë‹¨ì :**
    - ëª¨ë¸ ë³µì¡ì„±ìœ¼ë¡œ ì¸í•œ í•™ìŠµ ì‹œê°„ ì¦ê°€
    - ê³¼ì í•© ê°€ëŠ¥ì„±
    - ëª¨ë¸ í•´ì„ì˜ ì–´ë ¤ì›€

### 3. ê²½ëŸ‰í™” DNN ì½”ë“œ ì´í•´ ë° ì ìš© ë°©ì•ˆ ì—°êµ¬

#### 3.1. ê²½ëŸ‰í™” DNN ê°œìš”

ê²½ëŸ‰í™” DNNì€ ëª¨ë¸ í¬ê¸°ë¥¼ ì¤„ì´ê³  ì—°ì‚°ëŸ‰ì„ ê°ì†Œì‹œì¼œ, ëª¨ë°”ì¼ ê¸°ê¸°ë‚˜ ì„ë² ë””ë“œ ì‹œìŠ¤í…œê³¼ ê°™ì€ ì œí•œëœ í™˜ê²½ì—ì„œ DNN ëª¨ë¸ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤.

#### 3.2. ì£¼ìš” ê¸°ë²•

- **ëª¨ë¸ ì••ì¶• (Model Compression):**
    - ê°€ì§€ì¹˜ê¸° (Pruning): ì¤‘ìš”ë„ê°€ ë‚®ì€ ê°€ì¤‘ì¹˜ë¥¼ ì œê±°í•˜ì—¬ ëª¨ë¸ í¬ê¸° ì¶•ì†Œ
    - ì–‘ìí™” (Quantization): ê°€ì¤‘ì¹˜ ë° í™œì„±í™”ë¥¼ ì €ì •ë°€ë„ë¡œ í‘œí˜„í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ
    - ì§€ì‹ ì¦ë¥˜ (Knowledge Distillation): í° ëª¨ë¸ì˜ ì§€ì‹ì„ ì‘ì€ ëª¨ë¸ë¡œ ì „ë‹¬í•˜ì—¬ ì„±ëŠ¥ ìœ ì§€
- **íš¨ìœ¨ì ì¸ ë„¤íŠ¸ì›Œí¬ êµ¬ì¡° ì„¤ê³„ (Efficient Network Architecture Design):**
    - MobileNet, ShuffleNet ë“± ê²½ëŸ‰í™”ëœ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—°ì‚°ëŸ‰ ê°ì†Œ
    - **MobileNet:** Depthwise Separable Convolutionì„ ì‚¬ìš©í•˜ì—¬ ì—°ì‚°ëŸ‰ ê°ì†Œ
    - **ShuffleNet:** Channel Shuffle ì—°ì‚°ì„ ì‚¬ìš©í•˜ì—¬ ì •ë³´ íë¦„ ê°œì„ 

#### 3.3. ì½”ë“œ ì´í•´ ë° ì ìš© ë°©ì•ˆ

- **PyTorchë¥¼ ì‚¬ìš©í•œ ê²½ëŸ‰í™” DNN êµ¬í˜„:**
    ```
    import torch
    import torch.nn as nn

    class MobileNetV1(nn.Module):
        def __init__(self, num_classes=1000):
            super(MobileNetV1, self).__init__()
            # MobileNetV1 êµ¬ì¡° ì •ì˜
            self.features = nn.Sequential(
                # ... (MobileNetV1 ë ˆì´ì–´ ì •ì˜)
            )
            self.classifier = nn.Linear(1024, num_classes)

        def forward(self, x):
            x = self.features(x)
            x = nn.functional.avg_pool2d(x, 7)
            x = x.view(x.size(0), -1)
            x = self.classifier(x)
            return x
    ```
- **ì ìš© ë°©ì•ˆ:**
    - ì¶”ì²œ ì‹œìŠ¤í…œì— ì ìš©í•˜ê¸° ìœ„í•´ MobileNetê³¼ ê°™ì€ ê²½ëŸ‰í™” ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ë° ì•„ì´í…œ ì„ë² ë”©ì„ í•™ìŠµ
    - ì§€ì‹ ì¦ë¥˜ ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ë³µì¡í•œ ì¶”ì²œ ëª¨ë¸ì˜ ì§€ì‹ì„ ê²½ëŸ‰í™” ëª¨ë¸ë¡œ ì „ë‹¬
    - ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ ì‹¤ì‹œê°„ ì¶”ì²œì„ ì œê³µí•˜ê¸° ìœ„í•´ ëª¨ë¸ ìµœì í™”


ì¢‹ì€ ì§ˆë¬¸ì…ë‹ˆë‹¤! ê²‰ë³´ê¸°ì—ëŠ” Depthwiseì™€ Pointwise ë‘ ë‹¨ê³„ë¡œ ë‚˜ëˆ„ì–´ì ¸ì„œ ë” ë§ì€ ê³„ì‚°ì´ í•„ìš”í•´ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” í° í­ì˜ ê³„ì‚°ëŸ‰ ê°ì†Œê°€ ìˆìŠµë‹ˆë‹¤. êµ¬ì²´ì ì¸ ìˆ˜ì¹˜ë¡œ ë¹„êµí•´ë³´ê² ìŠµë‹ˆë‹¤:

### âœï¸ ì§€ë‚œ ë…¼ì˜ ì‚¬í•­ | ê³„ì‚°ëŸ‰ ë¹„êµ ì˜ˆì‹œ

ì¼ë°˜ì ì¸ Convolutionê³¼ Depthwise Separable Convolutionì„ ë¹„êµí•´ë´…ì‹œë‹¤.

- ì…ë ¥ ì±„ë„(C_in) = 256
- ì¶œë ¥ ì±„ë„(C_out) = 256
- ì»¤ë„ í¬ê¸°(K) = 3x3
- íŠ¹ì§•ë§µ í¬ê¸°(H x W) = 32x32

#### 1. ì¼ë°˜ Convolution
![alt text](image-3.png)
- ê³„ì‚°ëŸ‰ = $K \times K \times C_{in} \times C_{out} \times H \times W$
- ëŒ€ì…: 3 Ã— 3 Ã— 256 Ã— 256 Ã— 32 Ã— 32
- = 603,979,776 operations

#### 2. Depthwise Separable Convolution
![alt text](image-2.png)
1) Depthwise: $K \times K \times C_{in} \times H \times W$
   - 3 Ã— 3 Ã— 256 Ã— 32 Ã— 32 = 2,359,296 operations

2) Pointwise: $C_{in} \times C_{out} \times H \times W$
   - 256 Ã— 256 Ã— 32 Ã— 32 = 67,108,864 operations

**ì´ ì—°ì‚°ëŸ‰** = 2,359,296 + 67,108,864 = 69,468,160 operations

### ë¹„êµ ê²°ê³¼
- ì¼ë°˜ Convolution: 603,979,776 operations
- Depthwise Separable Conv: 69,468,160 operations
- **ì•½ 8.7ë°° ê°ì†Œ!**

### ì™œ ê°ì†Œí•˜ëŠ”ê°€?

1. **ì—°ì‚° ë¶„ë¦¬ì˜ íš¨ê³¼**
   - ì¼ë°˜ Convolution: ê³µê°„(KÃ—K)ê³¼ ì±„ë„(C_inÃ—C_out) ì •ë³´ë¥¼ ë™ì‹œì— ì²˜ë¦¬
   - Depthwise Separable: ê³µê°„ ì •ë³´(Depthwise)ì™€ ì±„ë„ ì •ë³´(Pointwise)ë¥¼ ë¶„ë¦¬í•´ì„œ ì²˜ë¦¬
   - ì´ ë¶„ë¦¬ë¡œ ì¸í•´ ê³±ì…ˆì˜ ì°¨ìˆ˜ê°€ ì¤„ì–´ë“¦

2. **ìˆ˜ì‹ìœ¼ë¡œ ë³´ëŠ” ê°ì†Œìœ¨**
   ì¼ë°˜ Conv ëŒ€ë¹„ Depthwise Separable Convì˜ ì—°ì‚°ëŸ‰ ë¹„ìœ¨:
   ```
   (K Ã— K Ã— C_in Ã— H Ã— W) + (C_in Ã— C_out Ã— H Ã— W)
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   (K Ã— K Ã— C_in Ã— C_out Ã— H Ã— W)
   
   = 1/C_out + 1/KÂ²
   ```
   - ì˜ˆì‹œì—ì„œëŠ” 1/256 + 1/9 â‰ˆ 0.115 (ì•½ 8.7ë°° ê°ì†Œ)

3. **ì‹œê°í™”**
```mermaid
graph LR
    A[ì…ë ¥ 256ì±„ë„] --> B[ì¼ë°˜ Conv]
    B --> C[ì¶œë ¥ 256ì±„ë„]
    
    D[ì…ë ¥ 256ì±„ë„] --> E[Depthwise<br>256ê°œì˜ 3x3 í•„í„°]
    E --> F[ì¤‘ê°„ 256ì±„ë„]
    F --> G[Pointwise<br>256ê°œì˜ 1x1 í•„í„°]
    G --> H[ì¶œë ¥ 256ì±„ë„]
    
    style B fill:#f96
    style E fill:#6cf
    style G fill:#6cf
```


## ì°¸ê³  ìë£Œ
*   Carlos A. Gomez-Uribe and Neil Hunt. 2016. The Netflix Recommender System: Algorithms, Business Value, and Innovation. ACM Trans. Manage. Inf. Syst. 6, 4, Article 13 (January 2016), 19 pages. [https://doi.org/10.1145/2843948](https://doi.org/10.1145/2843948)
*   Apple Music ì¶”ì²œ ì‹œìŠ¤í…œ ë¶„ì„: [https://www.apple.com/](https://www.apple.com/)
*   Spotify ì¶”ì²œ ì‹œìŠ¤í…œ ë¶„ì„: [https://www.spotify.com/](https://www.spotify.com/)
*   YouTube Music ì¶”ì²œ ì‹œìŠ¤í…œ ë¶„ì„: [https://music.youtube.com/](https://music.youtube.com/)

* NeuMF [https://wikidocs.net/178608](https://wikidocs.net/178608)
* DeepFM [https://supkoon.tistory.com/33](https://supkoon.tistory.com/33)
- [ë”¥ëŸ¬ë‹ ëª¨ë¸ ê²½ëŸ‰í™” ê¸°ìˆ  ë¶„ì„](https://repository.kisti.re.kr/bitstream/10580/15591/1/%28%EA%B8%B0%EC%88%A0%29%EB%94%A5%EB%9F%AC%EB%8B%9D%20%EB%AA%A8%EB%8D%B8%20%EA%B2%BD%EB%9F%89%ED%99%94%20%EA%B8%B0%EC%88%A0%20%EB%B6%84%EC%84%9D.pdf)
- [Deep Neural Network ê²½ëŸ‰í™”](https://velog.io/@juyeon048/%EB%94%A5-%EB%9F%AC%EB%8B%9D-Deep-Neural-Network-%EA%B2%BD%EB%9F%89%ED%99%94)
- [ë”¥ëŸ¬ë‹ ê²½ëŸ‰í™” íŠœí† ë¦¬ì–¼](https://ysbsb.github.io/model_compression/2021/10/15/model-compression-guide.html)
